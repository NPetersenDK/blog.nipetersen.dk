<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="NPetersen">
    <meta name="description" content="Hey :)">
    <meta name="keywords" content="blog,personal,responsive,search,font awesome,pages,posts,multilingual,highlight.js,syntax highlighting,premium,shortcuts">
    <meta name="generator" content="Hugo 0.64.1" />
    <title> NPetersen | Posts </title>
    <meta name="description" content="Posts - Hey :)">
    <meta itemprop="name" content="Posts">
    <meta itemprop="description" content="Posts - Hey :)">
    <meta property="og:title" content="Posts">
    <meta property="og:description" content="Posts - Hey :)">
    <meta property="og:image" content="https://www.gravatar.com/avatar/e831f8c92ff0853dd189d9d4f4295201?size=200">
    <meta property="og:url" content="/blog/posts/">
    <meta property="og:site_name" content="NPetersen"><meta property="og:type" content="website">

    


    
    <link href="/blog/posts/" rel="alternate" type="application/rss+xml" title="NPetersen" />
    <link href="/blog/posts/" rel="feed" type="application/rss+xml" title="NPetersen" />
    

    

    <link rel="stylesheet" href="/blog/theme.css">

    

    
    
    
</head>

<body class="bilberry-hugo-theme">

    
    <nav>

    <div class="container">
        <ul class="topnav">
            
            
            <li><a href="/blog/page/about-me/">About Me</a></li>
            
            
        </ul>

        
    </div>
</nav>


    
<header>

    <div class="container">
        <div class="logo">
            <a id="siteBaseUrl" href="/blog" class="logo">
                
                <img src="https://www.gravatar.com/avatar/e831f8c92ff0853dd189d9d4f4295201?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a
                    href="/blog">NPetersen</a></h3>
            
            <span class="subtitle">A nerdy blog by me - Mostly server and VMware related stuff. If you are liking what you see - please follow me below :)</span><br>
            
            <a href="https://twitter.com/NPetersenDK"><i class="fab fa-twitter"></i></a> | 
            <a href="https://github.com/NPetersenDK"><i class="fab fa-github"></i></a> | 
            <a href="https://www.linkedin.com/in/nipetersen/"><i class="fab fa-linkedin"></i></a> |
            <a href="https://facebook.com/HoompasDK"><i class="fab fa-facebook-f"></i></a>

        </div>

        

        
            <div class="toggler">
                
                <i class="fa fa-bars" aria-hidden="true"></i>
            </div>
        </div>
</header>


    <div class="main container">
        
    
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="/blog/posts/nsx-what-changed/">
    <i class="fas fa-fw fa-pencil-alt"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h1 class="article-title"><a href="/blog/posts/nsx-what-changed/">NSX Troubleshooting, what changed in the firewall?</a></h1>
    <div class="meta">
        
        
        <span class="date moment">2022-09-06</span>
        
        

        

        

        
    </div>

    
    <p>I found a neat feature that I didn&rsquo;t know in the NSX Manager during a late night.
Every publish/change makes a configuration point, that you can see what changed from then -&gt; now.</p>
<p>This can be good for troubleshooting, something that stops working, that might be due to a DFW Configuration issue.</p>
<p>Go to the DFW, over the categories click &ldquo;Actions&rdquo; -&gt; Under Drafts click &ldquo;View&rdquo;
You will be presented with the saved configurations:</p>
<p><a href="/blog/img/NSX-T_DFW-FWChanges.png"><img src="/blog/img/NSX-T_DFW-FWChanges.png" alt="NSX-T DFW Changes"></a></p>
<p>So lets go into troubleshooting mode, and lets say something stopped working at 10:32. I can find the date in the above screenshot and point at the dots and see the timestamps - look below:</p>
<p><a href="/blog/img/NSX-T_DFW-FWChanges-0609.png"><img src="/blog/img/NSX-T_DFW-FWChanges-0609.png" alt="NSX-T DFW Changes 0609"></a></p>
<p>If I open that, i can see the sections that contains changes, and what changed that will be, added/modified/removed if i load that config.</p>
<p><a href="/blog/img/NSX-T_DFW-FWChanges-FullDraft.png"><img src="/blog/img/NSX-T_DFW-FWChanges-FullDraft.png" alt="NSX-T Full Draft"></a></p>
<p>So whats visible here?</p>
<ul>
<li>What saved it (Would properly be System)</li>
<li>The user that did it</li>
<li>Modified time</li>
</ul>
<p>What are the draft changes?</p>
<ul>
<li>The sections that contain changes.</li>
<li>If you expand the section you can see the &ldquo;Red/Green/Orange&rdquo; symbol to the left that tells if the rule is getting created/removed.</li>
</ul>
<p>Remember it dosent show that a rule was created as &ldquo;Added&rdquo; but &ldquo;Deleted&rdquo;. That&rsquo;s because you will delete the rule when you load the config.</p>
<p><a href="/blog/img/NSX-T_DFW-FWChanges-DraftDifferences.png"><img src="/blog/img/NSX-T_DFW-FWChanges-DraftDifferences.png" alt="NSX-T Draft Diffs"></a></p>
<p>If we click load as you can see below you will be prompted and warned that you will do a full replace of the FW.</p>
<p><a href="/blog/img/NSX-T_DFW-FWChanges-Load.png"><img src="/blog/img/NSX-T_DFW-FWChanges-Load.png" alt="NSX-T Draft Load"></a></p>
<p>Doing that will as the warning say put you back to the DFW - where you can decide to Publish, make some changes or revert.</p>
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="/blog/posts/nsxt-40/">
    <i class="fas fa-fw fa-pencil-alt"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h1 class="article-title"><a href="/blog/posts/nsxt-40/">NSX-T 4.0.0.1 - Whats new?</a></h1>
    <div class="meta">
        
        
        <span class="date moment">2022-08-17</span>
        
        

        

        

        
    </div>

    
    <p>In NSX-T 4.0.0.1, VMware changed their naming scheme (again, would some say), to just be NSX.
One of the biggest features, and long overdue is IPv6 support for management. There is also a new feature for Blocking Malicious IPs, which we will look at below.</p>
<p>Here are the Release Notes: <a href="https://docs.vmware.com/en/VMware-NSX/4.0/rn/vmware-nsx-4001-release-notes/index.html">https://docs.vmware.com/en/VMware-NSX/4.0/rn/vmware-nsx-4001-release-notes/index.html</a></p>
<h1 id="block-malicious-ips">Block Malicious IPs:</h1>
<p>In the Release Notes the following is written:</p>
<ul>
<li>Block Malicious IPs in Distributed Firewall is a new capability that allows the ability to block traffic to and from Malicious IPs.</li>
<li>Block Malicious IPs in Distributed Firewall is a new capability that allows the ability to block traffic to and from Malicious IPs. This is achieved by ingesting a feed of Malicious IPs provided by Vmware Contexa. This feed is automatically updated multiple times a day so that the environment is protected with the latest malicious IPs. For existing environments the feature will need to be turned on explicitly. For new environments, the feature will be default enabled</li>
</ul>
<p>My LAB enviorment is a existing installation, so it will need to be turned off explicitly as the release notes says. Luckily thats quite easy in NSX-T.</p>
<p>We also know its a part of VMware Contexa, that is VMwares take on a cloud security platform. I actually didnt know about Contexa before this update, it looks cool. We might see more of Contexa in later NSX-Releases, maybe within NSX-Intelligence where more of the Contexa looks to be already.</p>
<h2 id="lets-setup-auto-update">Lets setup auto update:</h2>
<p>As you can see below, you will right away after upgrading the NSX-T Manager to 4.x the warnings telling you:
<em>Auto Update Malicious IPs is turned off. All rules containing groups with malicious IPs might not work at all or work with outdated data if available.</em></p>
<p><a href="/blog/img/NSX-T_DFW-Warnings-MaliciousIPS.png"><img src="/blog/img/NSX-T_DFW-Warnings-MaliciousIPS.png" alt="NSX-T DFW Warnings"></a></p>

    
    <a href="/blog/posts/nsxt-40/" class="more">Continue reading</a>
    
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="/blog/posts/my-homelab-2022/">
    <i class="fas fa-fw fa-pencil-alt"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h1 class="article-title"><a href="/blog/posts/my-homelab-2022/">My Homelab (2022 edition)</a></h1>
    <div class="meta">
        
        
        <span class="date moment">2022-08-16</span>
        
        

        

        

        
    </div>

    
    <p>I thought I would give an updated look at my HomeLab where i obviously lab most of my stuff.</p>
<h1 id="why">Why?</h1>
<p>My Homelab started as I think it does for many, a curiousity and passion to know more. For me it started way back when I was very young, and wanted to learn the enterprise stuff. It have made me get jobs where i havent had professional experiences, so I think it has paid off multiple times. Now its more of a playground, and to learn and try new stuff, beta releases and more.</p>
<h1 id="what">What?</h1>
<p>I work as a VMware and Datacenter Administrator in my daily work, so it helps me learn: Routing, VLANS, Switching (even L3 Switching), Datacenter management, VMware and more.
I LAB many things, but primarily most of the VMware stack, with licenses from VMUG.</p>
<p>VMware consists of:</p>
<ul>
<li>2 ESXi hosts with VSAN (Selfbuild - Xeon E-2236, 128GB RAM, 2x Capacity disks for VSAN, 2x 10G networking)</li>
<li>1 ESXi host (Intel NUC8i5BEH - i5-8259U, 32GB RAM, 1TB NVMe, 1x 10G networking via TB)</li>
<li>1 Nested VSAN Witness host</li>
<li>iSCSI storage as a supplement for VSAN using my Windows Server NAS (Storage Spaces, yes - it sucks)</li>
<li>vCenter (1)</li>
<li>NSX-T Manager (1), with no routing (VLAN Backed NSX-T Microsegmentation).</li>
<li>VMware vRA Suite</li>
<li>VMware vRLi</li>
</ul>
<h1 id="networking">Networking:</h1>
<h2 id="physical">Physical:</h2>
<ul>
<li>1x ES-48-500W (Ubiquiti)</li>
<li>1x ES-16-XG (Ubiquiti)</li>
<li>1x Unifi UDM</li>
</ul>
<p>All ESXi hosts has 10g from the ES-16-XG.
Unfortunately its impossible to get a hold of EdgeSwitches as of writing this, and i really want redundancy for my VSAN, so getting a ES-16-XG more would be lovely. I really dont like switches in Unifi, as they are very limited.</p>
<ul>
<li>Multiple VM&rsquo;s with VyOS with Wireguard for other sites.</li>
</ul>
<h2 id="network-setup">Network setup:</h2>
<ul>
<li>15 VLANS</li>
<li>1 VLAN for NSX VMs</li>
<li>Everything routed in Unifi UDM</li>
</ul>
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="/blog/posts/highlatencynsxt/">
    <i class="fas fa-fw fa-pencil-alt"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h1 class="article-title"><a href="/blog/posts/highlatencynsxt/">High latency for VMs in NSX-T (VLAN)</a></h1>
    <div class="meta">
        
        
        <span class="date moment">2022-08-15</span>
        
        

        

        

        
    </div>

    
    <p>NSX-T Version: 4.0.0.1.0.20159689</p>
<p>I was experiencing a high latency in NSX-T for all my VMs, and i couldnt figure out why. VMs on the same host, that wasnt on a NSX-T segment had +90ms in latency.
I was pinging from a VM on VLAN 10 to a VM thats part of my NSX environment on VLAN 20. Both VMs was on the same host, and I dont have any NSX-T Overlay routing, so it was kinda weird.</p>
<p>Let me first show you how the latency was fluctuating:
<img src="/blog/img/NSX-T_latency_issue.png" alt="NSX-T high VM latency"></p>
<p>As you can see above the latency was in the low end at 8ms and to the very high end of 150+ ms per ping. Thats not acceptable, and especially not when the VMs are on the same host, and there is only 1 router between the VLANs.</p>

    
    <a href="/blog/posts/highlatencynsxt/" class="more">Continue reading</a>
    
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="/blog/posts/witnesshostmaintenance/">
    <i class="fas fa-fw fa-pencil-alt"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h1 class="article-title"><a href="/blog/posts/witnesshostmaintenance/">Place a VSAN Witness host into maintenance through PowerCLI</a></h1>
    <div class="meta">
        
        
        <span class="date moment">2022-07-24</span>
        
        

        

        

        
    </div>

    
    <p>The PowerCLI documentation is actually really good, but sometimes the documentation is just silly aswell. I was trying to make a vSAN Witness host go into Maintenance Mode through PowerCLI and had trouble doing it.</p>
<p>The Set-VMHost command has some parameters you can set for VSAN Data Migration and stuff like that, so i thought maybe it wanted to do something with vSAN even though the GUI is the normal Maintenance Mode dialog box.</p>
<p><img src="/blog/img/vCSA_Witness_MM.png" alt="vCenter GUI VSAN MM Mode"></p>
<p>When I tried using the Set-VMHost command i got the error A specified parameter was not correct:</p>

    
    <a href="/blog/posts/witnesshostmaintenance/" class="more">Continue reading</a>
    
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="/blog/posts/github/">
    <i class="fas fa-fw fa-pencil-alt"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h1 class="article-title"><a href="/blog/posts/github/">Follow me on Github :)</a></h1>
    <div class="meta">
        
        
        <span class="date moment">2020-02-18</span>
        
        

        

        

        
    </div>

    
    <p>Remember to follow me on Github, since i post a lot of my scripts there. I&rsquo;m mostly doing PowerShell stuff, so keep an eye out.</p>
<p>I made a repository for VMware for my scripts for VMware - take a look here: <a href="https://github.com/NPetersenDK/VMware-Scripts">https://github.com/NPetersenDK/VMware-Scripts</a></p>

    
    <a href="/blog/posts/github/" class="more">Continue reading</a>
    
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="/blog/posts/my-homelab/">
    <i class="fas fa-fw fa-pencil-alt"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h1 class="article-title"><a href="/blog/posts/my-homelab/">My Homelab</a></h1>
    <div class="meta">
        
        
        <span class="date moment">2020-02-14</span>
        
        

        

        

        
    </div>

    
    <p>My homelab is based on 4 hosts and one fileserver (running Windows, for now).</p>
<h2 id="my-vmware-installation">My VMware Installation</h2>
<p>I try to be a front runner for running the newest version of everything. So as of now i&rsquo;m on 6.7U3 on everything.
I have 5 hosts in my installation, which one of them is in France (i&rsquo;m living in Denmark) - i have a 500/500 Mbit connection to it.</p>

    
    <a href="/blog/posts/my-homelab/" class="more">Continue reading</a>
    
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

            
        </div>
    

    
    <div class="paginator">
        
            <a href="/blog/posts/page/2/" class="older"><i class="fa fa-angle-double-left"></i> Older posts</a>
        

        
    </div>



    </div>

    

<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/NPetersenDK" target="_blank">
                &copy;
                
                2022
                
                by Nikolaj Petersen - special thanks to Lednerb
            </a>
            -
            <a href="/blog/posts/index.xml">RSS</a>
        </div>
        <div class="author">
            <a href="https://nipetersen.dk/about/"
                target="_blank">NiPetersen.dk - A personal website for Nikolaj</a>
        </div>
    </div>
</div>


    

    


    <script type="text/javascript" src="/blog/theme.js"></script>

    
    
    

    


</body>

</html>
